(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-b118"],{"0MxA":function(e,t,r){},"1MdA":function(e,t,r){},"6z9e":function(e,t,r){"use strict";r.d(t,"a",function(){return o}),r.d(t,"b",function(){return l});var a=r("HejF"),i=r("GcbA"),n=r("7Qib");function o(e){var t=e%100;return Math.floor(e/100)+"."+(t>=10?t:"0"+t)}function l(e,t){var r=Object(n.a)(e);delete r.page,delete r.limit;var o=a.a.baseURL;return o+=t?"/balance/admin/history-download":"/balance/history-download",Object(i.a)(o,r)}},GcbA:function(e,t,r){"use strict";r.d(t,"a",function(){return u});var a=r("gDS+"),i=r.n(a),n=r("EJiy"),o=r.n(n);function l(e){return"[object Array]"===Object.prototype.toString.call(e)}function s(e,t){if(null!==e&&void 0!==e)if("object"!==(void 0===e?"undefined":o()(e))&&(e=[e]),l(e))for(var r=0,a=e.length;r<a;r++)t.call(null,e[r],r,e);else for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.call(null,e[i],i,e)}function c(e){return encodeURIComponent(e).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function u(e,t){if(!t)return e;var r=[];s(t,function(e,t){null!==e&&void 0!==e&&(l(e)?t+="[]":e=[e],s(e,function(e){!function(e){return"[object Date]"===Object.prototype.toString.call(e)}(e)?function(e){return null!==e&&"object"===(void 0===e?"undefined":o()(e))}(e)&&(e=i()(e)):e=e.toISOString(),r.push(c(t)+"="+c(e))}))});var a=r.join("&");if(a){var n=e.indexOf("#");-1!==n&&(e=e.slice(0,n)),e+=(-1===e.indexOf("?")?"?":"&")+a}return e}},HejF:function(e,t,r){"use strict";t.a={baseURL:"https://e--delivery-dev.chinacloudsites.cn/api"}},"I+qt":function(e,t,r){"use strict";var a=r("ZwJt");r.n(a).a},VPCY:function(e,t,r){"use strict";var a=r("0MxA");r.n(a).a},VQkJ:function(e,t,r){"use strict";var a=r("ezwb");r.n(a).a},ZDUp:function(e,t,r){"use strict";r.r(t);var a=r("QbLZ"),i=r.n(a),n=r("ygCS"),o=r.n(n),l={props:{text:{type:null|String,required:!0},size:{type:Number,required:!1,default:256},color:{type:String,required:!1,default:"#000"},bgColor:{type:String,required:!1,default:"#FFF"},errorLevel:{type:String,validator:function(e){return"L"===e||"M"===e||"Q"===e||"H"===e},required:!1,default:"H"}},data:function(){return{qrCode:{}}},watch:{text:function(){this.clear(),this.makeCode(this.text)}},mounted:function(){this.qrCode=new o.a(this.$el,{text:this.text,width:this.size,height:this.size,colorDark:this.color,colorLight:this.bgColor,correctLevel:o.a.CorrectLevel[this.errorLevel]})},methods:{clear:function(){this.qrCode.clear()},makeCode:function(e){this.qrCode.makeCode(e)}}},s=r("KHd+"),c=Object(s.a)(l,function(){var e=this.$createElement;return(this._self._c||e)("div")},[],!1,null,null,null);c.options.__file="QrCode.vue";var u=c.exports,d=r("+iC2"),h=r("6z9e"),f={props:{pricePlans:{type:Object,default:function(){return{}}}},data:function(){return{list:[],tableHeader:[]}},watch:{pricePlans:function(){this.refresh()}},methods:{refresh:function(){this.pricePlans||(this.list=[],this.tableHeader=[]);var e=[],t=[];for(var r in this.pricePlans){var a=Object(d.c)(r),i=this.pricePlans[r],n={"用户级别":a},o=0;for(var l in i.fixedWeightPrices){var s=parseInt(l);-1===t.indexOf(s)&&t.push(s);var c=(s/=1e3)+"公斤",u=Object(h.a)(i.fixedWeightPrices[l]);n[c]=u||"",o<s&&(o=s)}for(var f=i.fixedWeightPrices[1e3*o],p=o+1;p<=20;p++){var v=p+"公斤",m=f+(p-o)*i.pricePerKg,b=Object(h.a)(m);n[v]=b||""}n["续重/公斤"]=Object(h.a)(i.pricePerKg)||"待定",e.push(n)}for(var g=t.sort(function(e,t){return e-t}).map(function(e){return e/1e3}),y=g[g.length-1]+1;y<=20;y++)g.push(y);var _=g.map(function(e){return e+"公斤"});this.list=e,this.tableHeader=["用户级别"].concat(_)}}},p=(r("I+qt"),Object(s.a)(f,function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"component-container"},[t("el-table",{staticStyle:{width:"100%","margin-top":"20px"},attrs:{data:this.list,"show-header":!0,fit:"","highlight-current-row":""}},this._l(this.tableHeader,function(e){return t("el-table-column",{key:e,attrs:{prop:e,label:e}})}))],1)},[],!1,null,"7ba305f4",null));p.options.__file="PricePlanTable.vue";var v=p.exports,m=r("t3Un");var b=r("L2JU"),g={name:"BalanceCharge",components:{QrCode:u,PricePlanTable:v},data:function(){var e=function(e,t,r){var a=parseInt(t);a>=1||!a?r():r(new Error("支付金额不能小于1元"))};return{pricePlans:null,chargeForm:{money:"200",otherAmount:""},chargeRules:{money:[{required:!1,trigger:"blur",validator:e}],otherAmount:[{required:!1,trigger:"blur",validator:e}]},isLoading:!1,payDialogVisible:!1,isPaying:!1,orderId:"",payUrl:"",payMoney:0,timeoutAt:0,leftTime:"",interval:null}},computed:i()({},Object(b.b)(["isAgent"])),created:function(){var e=this;Object(m.a)({url:"/price-plan/list",method:"get"}).then(function(t){0===(t=t.data).errorCode&&(e.pricePlans=t.item)});var t=0;this.interval=window.setInterval(function(){++t%10==0&&e.orderId&&e.isPaying&&e.queryOrderStatus();var r=Date.now();if(e.timeoutAt&&e.timeoutAt<=r)e.resetPayment();else{var a=Math.floor((e.timeoutAt-r)/1e3),i=Math.floor(a/60);a-=60*i,e.leftTime=i>0?i+"分":"",e.leftTime+=a+"秒"}},1e3)},destroyed:function(){window.clearInterval(this.interval)},methods:{handleCharge:function(){var e=this;this.payUrl&&(this.payDialogVisible=!0),this.$refs.chargeForm.validate(function(t){if(t){var r=e.chargeForm.otherAmount||e.chargeForm.money;try{if((r=parseFloat(r))<1)return void e.$message.error("请选择或者输入合法金额, 最低1元")}catch(t){return void e.$message.error("请选择或者输入合法金额, 最低1元")}e.isLoading=!0,e.resetPayment(),e.$store.dispatch("GetPaymentQrCode",r).then(function(t){e.isLoading=!1,t.qrCode||e.resetPayment(),e.payDialogVisible=!0,e.isPaying=!0,e.orderId=t.order,e.payUrl=t.qrCode,e.payMoney=t.money,e.timeoutAt=1e3*t.times})}})},queryOrderStatus:function(){var e=this;this.$store.dispatch("QueryPaymentOrder",this.orderId).then(function(t){0!==t.code&&(e.resetPayment(),1===t.code?(e.$message.success("付款完成"),e.$store.dispatch("GetUserInfo",!0).then(function(){e.$router.go(-1)})):2===t.code?e.$message.error("付款超时"):3===t.code?e.$message.error("付款订单不存在或者超时被删除"):4===t.code&&e.$message.error("token错误"))})},resetPayment:function(){this.payDialogVisible=!1,this.isPaying=!1,this.orderId="",this.payUrl="",this.payMoney=0,this.leftTime="",this.timeoutAt=0}}},y=(r("VPCY"),r("VQkJ"),r("kIMQ"),Object(s.a)(g,function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"charge-container"},[e.isAgent?e._e():r("el-card",[r("div",{attrs:{slot:"header"},slot:"header"},[r("span",[e._v("收费标准")])]),e._v(" "),r("price-plan-table",{attrs:{"price-plans":e.pricePlans}}),e._v(" "),r("div",{staticClass:"tip-container"},[e._v("一次性充值1000元，自动升级为VIP用户，享受VIP优惠。")])],1),e._v(" "),r("el-form",{ref:"chargeForm",staticClass:"charge-form",attrs:{model:e.chargeForm,rules:e.chargeRules,"auto-complete":"on","label-position":"left"},on:{submit:function(t){return t.preventDefault(),e.handleCharge(t)}}},[r("el-form-item",{attrs:{prop:"money",label:"充值金额"}},[r("el-radio-group",{model:{value:e.chargeForm.money,callback:function(t){e.$set(e.chargeForm,"money",t)},expression:"chargeForm.money"}},[r("el-radio",{attrs:{label:"10",border:""}},[e._v("10.00元")]),e._v(" "),r("el-radio",{attrs:{label:"100",border:""}},[e._v("100.00元")]),e._v(" "),r("el-radio",{attrs:{label:"200",border:""}},[e._v("200.00元")]),e._v(" "),r("el-radio",{attrs:{label:"500",border:""}},[e._v("500.00元")]),e._v(" "),r("el-radio",{attrs:{label:"1000",border:""}},[e._v("1000.00元")]),e._v(" "),r("el-radio",{attrs:{label:"2000",border:""}},[e._v("2000.00元")]),e._v(" "),r("el-radio",{attrs:{label:"5000",border:""}},[e._v("5000.00元")]),e._v(" "),r("el-radio",{attrs:{label:"10000",border:""}},[e._v("10000.00元")]),e._v(" "),r("el-radio",{attrs:{label:"20000",border:""}},[e._v("20000.00元")])],1)],1),e._v(" "),r("el-form-item",{attrs:{prop:"otherAmount",label:"其他金额"}},[r("el-input",{attrs:{placeholder:e.$t("balance.otherAmount"),type:"number"},model:{value:e.chargeForm.otherAmount,callback:function(t){e.$set(e.chargeForm,"otherAmount",t)},expression:"chargeForm.otherAmount"}})],1),e._v(" "),r("el-button",{staticStyle:{width:"100%","margin-bottom":"30px"},attrs:{type:"primary"},nativeOn:{click:function(t){return t.preventDefault(),e.handleCharge(t)}}},[e._v(e._s(e.$t("balance.charge")))])],1),e._v(" "),r("el-dialog",{attrs:{visible:e.payDialogVisible,width:"450px",center:""},on:{"update:visible":function(t){e.payDialogVisible=t}}},[r("div",{staticClass:"pay-container"},[r("div",[r("span",[e._v("付款订单还剩")]),e._v(" "),r("span",{staticClass:"timeout-warning"},[e._v(e._s(e.leftTime))])]),e._v(" "),r("div",{staticClass:"tips-container"},[e._v("\n        若订单超时请不要付款，付款金额务必与所选择的金额一致.\n      ")]),e._v(" "),r("div",{staticClass:"money-container"},[e._v(e._s(e.payMoney)+"元")]),e._v(" "),r("qr-code",{attrs:{text:e.payUrl,size:400,"error-level":"H",color:"#34495e"}})],1)])],1)},[],!1,null,"3a9247aa",null));y.options.__file="charge.vue";t.default=y.exports},ZwJt:function(e,t,r){},ezwb:function(e,t,r){},kIMQ:function(e,t,r){"use strict";var a=r("1MdA");r.n(a).a}}]);