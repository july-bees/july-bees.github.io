(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-d7ca"],{"60i2":function(e,t,r){},"P+z1":function(e,t,r){"use strict";r.r(t);var a=r("QbLZ"),s=r.n(a),i=r("OyzN"),o=r.n(i),n=r("wk8/"),l=r("ZySA"),u=r("+iC2"),c={name:"UserEdit",props:{user:{default:function(){return{}},type:Object}},data:function(){return{allLevels:Object(u.a)().map(function(e){return{label:Object(u.c)(e),value:e}}),updateForm:{userName:this.user.userName,level:this.user.level},createRules:{userName:[{required:!0,trigger:"blur",validator:function(e,t,r){t?r():r(new Error("用户名不能为空"))}}],level:[{required:!0,trigger:"blur",validator:function(e,t,r){t?r():r(new Error("用户等级不能为空"))}}]},isLoading:!1}},watch:{user:function(){this.updateForm={userName:this.user.userName,level:this.user.level}}},methods:{handleUpdate:function(){var e=this;this.$refs.updateForm.validate(function(t){t&&(e.loading=!0,Object(n.c)(e.updateForm).then(function(t){e.loading=!1,(t=t.data).errorMessage?e.$message.error(t.errorMessage):(e.$message.success("操作成功"),e.user.userName=t.item.userName,e.user.level=t.item.level,e.$emit("success"))}).catch(function(t){e.loading=!1,e.$message.error(t)}))})}}},m=r("KHd+"),d=Object(m.a)(c,function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-form",{ref:"updateForm",attrs:{model:e.updateForm,rules:e.createRules,"auto-complete":"on","label-position":"left","label-width":"120px"},on:{submit:function(t){return t.preventDefault(),e.handleUpdate(t)}}},[r("el-form-item",{attrs:{prop:"userName",label:"用户名"}},[r("el-input",{attrs:{disabled:!0,type:"text"},model:{value:e.updateForm.userName,callback:function(t){e.$set(e.updateForm,"userName",t)},expression:"updateForm.userName"}})],1),e._v(" "),r("el-form-item",{attrs:{prop:"level",label:"用户等级"}},[r("el-select",{model:{value:e.updateForm.level,callback:function(t){e.$set(e.updateForm,"level",t)},expression:"updateForm.level"}},e._l(e.allLevels,function(e){return r("el-option",{key:e.label,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),r("el-button",{staticStyle:{width:"100%","margin-bottom":"10px"},attrs:{type:"primary"},nativeOn:{click:function(t){return t.preventDefault(),e.handleUpdate(t)}}},[e._v("确认")])],1)},[],!1,null,null,null);d.options.__file="UserEdit.vue";var p=d.exports,f=r("gMSW"),v={name:"UserCost",props:{user:{default:function(){return{}},type:Object}},data:function(){return{allSpeficiations:["升级至VIP","升级至代理"],costForm:{userName:this.user.userName,money:0,specification:""},createRules:{userName:[{required:!0,trigger:"blur",validator:function(e,t,r){t?r():r(new Error("用户名不能为空"))}}],money:[{required:!0,trigger:"blur",validator:function(e,t,r){t>0?r():r(new Error("扣费金额不能为空"))}}],specification:[{required:!0,trigger:"blur",validator:function(e,t,r){t?r():r(new Error("扣费备注不能为空"))}}]},isLoading:!1}},watch:{user:function(){this.costForm={userName:this.user.userName}}},methods:{querySpecificationSearch:function(e,t){for(var r=[],a=0;a<this.allSpeficiations.length&&r.length<=5;a++)e&&-1===this.allSpeficiations[a].indexOf(e)||r.push(this.allSpeficiations[a]);return t(r.map(function(e){return{value:e}}))},handleUpdate:function(){var e=this;this.$refs.costForm.validate(function(t){if(t){var r=e.costForm.money;try{if((r=parseFloat(r))<=0)return void e.$message.error("请输入合法金额")}catch(t){return void e.$message.error("请输入合法金额")}e.costForm.money=r,e.isLoading=!0,Object(f.c)(e.costForm).then(function(t){e.loading=!1,(t=t.data).errorMessage?e.$message.error(t.errorMessage):(e.$message.success("操作成功"),e.user.userName=t.item.userName,e.user.money=t.item.to,e.$emit("success"))}).catch(function(t){e.loading=!1,e.$message.error(t)})}})}}},h=Object(m.a)(v,function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-form",{ref:"costForm",attrs:{model:e.costForm,rules:e.createRules,"auto-complete":"on","label-position":"left","label-width":"120px"},on:{submit:function(t){return t.preventDefault(),e.handleUpdate(t)}}},[r("el-form-item",{attrs:{prop:"userName",label:"用户名"}},[r("el-input",{attrs:{disabled:!0,type:"text"},model:{value:e.costForm.userName,callback:function(t){e.$set(e.costForm,"userName",t)},expression:"costForm.userName"}})],1),e._v(" "),r("el-form-item",{attrs:{prop:"money",label:"金额"}},[r("el-input",{attrs:{type:"text"},model:{value:e.costForm.money,callback:function(t){e.$set(e.costForm,"money",t)},expression:"costForm.money"}})],1),e._v(" "),r("el-form-item",{attrs:{prop:"specification",label:"备注"}},[r("el-autocomplete",{staticClass:"filter-item",attrs:{"fetch-suggestions":e.querySpecificationSearch,clearable:""},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.item;return[r("div",[e._v(e._s(a.value))])]}}]),model:{value:e.costForm.specification,callback:function(t){e.$set(e.costForm,"specification",t)},expression:"costForm.specification"}})],1),e._v(" "),r("el-button",{staticStyle:{width:"100%","margin-bottom":"10px"},attrs:{type:"primary"},nativeOn:{click:function(t){return t.preventDefault(),e.handleUpdate(t)}}},[e._v("确认")])],1)},[],!1,null,null,null);h.options.__file="UserCost.vue";var g=h.exports,b={name:"UserCharge",props:{user:{default:function(){return{}},type:Object}},data:function(){return{allChannels:["奖励"],costForm:{userName:this.user.userName,money:0,channel:""},createRules:{userName:[{required:!0,trigger:"blur",validator:function(e,t,r){t?r():r(new Error("用户名不能为空"))}}],money:[{required:!0,trigger:"blur",validator:function(e,t,r){t>0?r():r(new Error("扣费金额不能为空"))}}],channel:[{required:!0,trigger:"blur",validator:function(e,t,r){t?r():r(new Error("扣费备注不能为空"))}}]},isLoading:!1}},watch:{user:function(){this.costForm={userName:this.user.userName}}},methods:{queryChannelSearch:function(e,t){for(var r=[],a=0;a<this.allChannels.length&&r.length<=5;a++)e&&-1===this.allChannels[a].indexOf(e)||r.push(this.allChannels[a]);return t(r.map(function(e){return{value:e}}))},handleUpdate:function(){var e=this;this.$refs.costForm.validate(function(t){if(t){var r=e.costForm.money;try{if((r=parseFloat(r))<=0)return void e.$message.error("请输入合法金额")}catch(t){return void e.$message.error("请输入合法金额")}e.costForm.money=r,e.isLoading=!0,Object(f.b)(e.costForm).then(function(t){e.loading=!1,(t=t.data).errorMessage?e.$message.error(t.errorMessage):(e.$message.success("操作成功"),e.user.userName=t.item.userName,e.user.money=t.item.to,e.$emit("success"))}).catch(function(t){e.loading=!1,e.$message.error(t)})}})}}},y=Object(m.a)(b,function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-form",{ref:"costForm",attrs:{model:e.costForm,rules:e.createRules,"auto-complete":"on","label-position":"left","label-width":"120px"},on:{submit:function(t){return t.preventDefault(),e.handleUpdate(t)}}},[r("el-form-item",{attrs:{prop:"userName",label:"用户名"}},[r("el-input",{attrs:{disabled:!0,type:"text"},model:{value:e.costForm.userName,callback:function(t){e.$set(e.costForm,"userName",t)},expression:"costForm.userName"}})],1),e._v(" "),r("el-form-item",{attrs:{prop:"money",label:"金额"}},[r("el-input",{attrs:{type:"text"},model:{value:e.costForm.money,callback:function(t){e.$set(e.costForm,"money",t)},expression:"costForm.money"}})],1),e._v(" "),r("el-form-item",{attrs:{prop:"channel",label:"备注"}},[r("el-autocomplete",{staticClass:"filter-item",attrs:{"fetch-suggestions":e.queryChannelSearch,clearable:""},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.item;return[r("div",[e._v(e._s(a.value))])]}}]),model:{value:e.costForm.channel,callback:function(t){e.$set(e.costForm,"channel",t)},expression:"costForm.channel"}})],1),e._v(" "),r("el-button",{staticStyle:{width:"100%","margin-bottom":"10px"},attrs:{type:"primary"},nativeOn:{click:function(t){return t.preventDefault(),e.handleUpdate(t)}}},[e._v("确认")])],1)},[],!1,null,null,null);y.options.__file="UserCharge.vue";var w=y.exports,_=r("7Qib"),C={name:"UserQuery",directives:{waves:l.a},components:{UserEdit:p,UserCost:g,UserCharge:w},props:{isAdminMode:{default:!1,type:Boolean}},data:function(){return{allLevels:Object(u.a)().map(function(e){return{label:Object(u.c)(e),value:e}}),queryPickerOptions:{shortcuts:[{text:"今天",onClick:function(e){var t=new Date((new Date).toDateString()),r=new Date((new Date).setHours(23,59,59));e.$emit("pick",[t,r])}},{text:"昨天",onClick:function(e){var t=new Date;t.setTime(t.getTime()-864e5);var r=new Date(t.toDateString()),a=new Date(t.setHours(23,59,59));e.$emit("pick",[r,a])}},{text:"最近一周",onClick:function(e){var t=new Date;t.setTime(t.getTime()-6048e5);var r=new Date(t.toDateString()),a=new Date((new Date).setHours(23,59,59));e.$emit("pick",[r,a])}},{text:"当月",onClick:function(e){var t=new Date;t.setDate(1),t.setHours(0,0,0);var r=new Date;r.setHours(23,59,59),e.$emit("pick",[t,r])}},{text:"上个月",onClick:function(e){var t=new Date;t.setMonth(t.getMonth()-1),t.setDate(1),t.setHours(0,0,0);var r=new Date;r.setDate(0),r.setHours(23,59,59),e.$emit("pick",[t,r])}}]},query:{level:"",userName:"",phone:"",qq:"",period:[new Date((new Date).getFullYear()+"-01-01 00:00:00"),new Date((new Date).setHours(23,59,59))],page:1,limit:20},loading:!1,users:[],size:0,total:0,lastQuery:null,balanceDialogVisible:!1,editDialogVisible:!1,userToEdit:null,costDialogVisible:!1,userToCost:null,chargeDialogVisible:!1,userToCharge:null}},created:function(){this.fetch(this.query)},methods:{fetch:function(e){var t=this,r=Object(_.a)(e);return o()(r).forEach(function(e){r[e]||delete r[e]}),r.period&&r.period.length>0&&(r.from=r.period[0],r.to=r.period[1],delete r.period),this.lastQuery=r,this.loading=!0,Object(n.b)(r,this.isAdminMode).then(function(e){t.loading=!1;var r=e.data;0!==r.errorCode&&t.$message.error(r.errorMessage),t.size=r.size,t.total=r.total,t.users=r.items;var a=(r.page-1)*r.limit;a<0&&(a=0),t.users.forEach(function(e,t){e.index=a+t+1})})},queryByFilter:function(){this.query.page=1,this.fetch(this.query)},handleSizeChange:function(e){this.query.limit=e,this.loading=!0,this.fetch(this.query)},handleCurrentChange:function(e){this.query.page=e,this.loading=!0,this.fetch(this.query)},openEditDialog:function(e){this.userToEdit=e,this.editDialogVisible=!0},closeEditDialog:function(){this.editDialogVisible=!1},openCostDialog:function(e){this.userToCost=e,this.costDialogVisible=!0},closeCostDialog:function(){this.costDialogVisible=!1},openChargeDialog:function(e){this.userToCharge=e,this.chargeDialogVisible=!0},closeChargeDialog:function(){this.chargeDialogVisible=!1}}},x=(r("VVG0"),Object(m.a)(C,function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"app-container"},[r("el-row",{attrs:{gutter:10}},[r("el-col",[r("div",{staticClass:"filter-container"},[r("label",{staticClass:"filter-item"},[e._v("注册时间")]),e._v(" "),r("el-date-picker",{staticClass:"filter-item",attrs:{"picker-options":e.queryPickerOptions,"default-time":["00:00:00","23:59:59"],type:"datetimerange","range-separator":"至","start-placeholder":"开始时间","end-placeholder":"结束时间"},model:{value:e.query.period,callback:function(t){e.$set(e.query,"period",t)},expression:"query.period"}})],1),e._v(" "),r("div",{staticClass:"filter-container"},[r("label",{staticClass:"filter-item"},[e._v("用户等级")]),e._v(" "),r("el-select",{staticClass:"filter-item",model:{value:e.query.level,callback:function(t){e.$set(e.query,"level",t)},expression:"query.level"}},[r("el-option",{key:"",attrs:{label:"全部",value:""}}),e._v(" "),e._l(e.allLevels,function(e){return r("el-option",{key:e.label,attrs:{label:e.label,value:e.value}})})],2),e._v(" "),r("label",{staticClass:"filter-item"},[e._v("用户名")]),e._v(" "),r("el-input",{staticClass:"filter-item",staticStyle:{width:"160px"},attrs:{clearable:"",placeholder:"默认: 全部用户"},model:{value:e.query.userName,callback:function(t){e.$set(e.query,"userName",t)},expression:"query.userName"}}),e._v(" "),r("label",{staticClass:"filter-item"},[e._v("手机号")]),e._v(" "),r("el-input",{staticClass:"filter-item",staticStyle:{width:"200px"},attrs:{clearable:""},model:{value:e.query.phone,callback:function(t){e.$set(e.query,"phone",t)},expression:"query.phone"}}),e._v(" "),r("label",{staticClass:"filter-item"},[e._v("QQ号")]),e._v(" "),r("el-input",{staticClass:"filter-item",staticStyle:{width:"200px"},attrs:{clearable:""},model:{value:e.query.qq,callback:function(t){e.$set(e.query,"qq",t)},expression:"query.qq"}}),e._v(" "),r("el-button",{directives:[{name:"waves",rawName:"v-waves"}],staticClass:"filter-item",attrs:{loading:e.loading,type:"primary",icon:"el-icon-search"},on:{click:e.queryByFilter}},[e._v("查询")])],1)])],1),e._v(" "),r("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%","margin-top":"20px"},attrs:{data:e.users,border:"",fit:"",stripe:"","highlight-current-row":""}},[r("el-table-column",{attrs:{label:"序号",fixed:"",width:"60"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",[e._v(e._s(t.row.index))])]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"操作",width:"240",fixed:""},scopedSlots:e._u([{key:"default",fn:function(t){return[r("div",{staticClass:"operation-container"},[r("el-button",{directives:[{name:"waves",rawName:"v-waves"}],attrs:{type:"success",size:"mini",round:""},on:{click:function(r){e.openEditDialog(t.row)}}},[e._v("\n            修改等级\n          ")])],1),e._v(" "),r("div",{staticClass:"operation-container"},[r("el-button",{directives:[{name:"waves",rawName:"v-waves"}],attrs:{type:"warning",size:"mini",round:""},on:{click:function(r){e.openCostDialog(t.row)}}},[e._v("\n            扣费\n          ")])],1),e._v(" "),e.isAdminMode?r("div",{staticClass:"operation-container"},[r("el-button",{directives:[{name:"waves",rawName:"v-waves"}],attrs:{type:"danger",size:"mini",round:""},on:{click:function(r){e.openChargeDialog(t.row)}}},[e._v("\n            充值\n          ")])],1):e._e()]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"用户名","min-width":"110"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",[e._v(e._s(t.row.userName))])]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"等级","min-width":"110"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",[e._v(e._s(e._f("parseUserLevel")(t.row.level)))])]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"余额",width:"110"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",[e._v(e._s(t.row.money))])]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"手机号","min-width":"110"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",[e._v(e._s(t.row.phone))])]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"QQ号","min-width":"110"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",[e._v(e._s(t.row.qq))])]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"最近登陆时间","min-width":"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",[e._v(e._s(e._f("parseTime")(t.row.lastLoginTime)))])]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"最近登陆IP",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",[e._v(e._s(t.row.lastIp))])]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"注册时间","min-width":"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",[e._v(e._s(e._f("parseTime")(t.row.createdTime)))])]}}])})],1),e._v(" "),r("div",{staticClass:"pagination-container"},[r("el-pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total > 0"}],attrs:{"current-page":e.query.page,"page-sizes":[20,50,100,200],"page-size":e.query.limit,total:e.total,background:"",layout:"total, sizes, prev, pager, next, jumper"},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),e._v(" "),r("el-dialog",{attrs:{visible:e.editDialogVisible,title:"修改用户等级",top:"20px",width:"600px",center:""},on:{"update:visible":function(t){e.editDialogVisible=t}}},[r("user-edit",{attrs:{user:e.userToEdit},on:{success:e.closeEditDialog}})],1),e._v(" "),r("el-dialog",{attrs:{visible:e.costDialogVisible,title:"手工扣费",top:"20px",width:"600px",center:""},on:{"update:visible":function(t){e.costDialogVisible=t}}},[r("user-cost",{attrs:{user:e.userToCost},on:{success:e.closeCostDialog}})],1),e._v(" "),r("el-dialog",{attrs:{visible:e.chargeDialogVisible,title:"手工充值",top:"20px",width:"600px",center:""},on:{"update:visible":function(t){e.chargeDialogVisible=t}}},[r("user-charge",{attrs:{user:e.userToCharge},on:{success:e.closeChargeDialog}})],1)],1)},[],!1,null,"7aa488c4",null));x.options.__file="UserQuery.vue";var D=x.exports,k=r("L2JU"),q={name:"AdminUserQuery",components:{UserQuery:D},computed:s()({},Object(k.b)(["isAdmin"]))},F=Object(m.a)(q,function(){var e=this.$createElement;return(this._self._c||e)("user-query",{attrs:{"is-admin-mode":this.isAdmin}})},[],!1,null,null,null);F.options.__file="users.vue";t.default=F.exports},VVG0:function(e,t,r){"use strict";var a=r("60i2");r.n(a).a},ZySA:function(e,t,r){"use strict";var a=r("P2sY"),s=r.n(a),i=(r("jUE0"),{bind:function(e,t){e.addEventListener("click",function(r){var a=s()({},t.value),i=s()({ele:e,type:"hit",color:"rgba(0, 0, 0, 0.15)"},a),o=i.ele;if(o){o.style.position="relative",o.style.overflow="hidden";var n=o.getBoundingClientRect(),l=o.querySelector(".waves-ripple");switch(l?l.className="waves-ripple":((l=document.createElement("span")).className="waves-ripple",l.style.height=l.style.width=Math.max(n.width,n.height)+"px",o.appendChild(l)),i.type){case"center":l.style.top=n.height/2-l.offsetHeight/2+"px",l.style.left=n.width/2-l.offsetWidth/2+"px";break;default:l.style.top=(r.pageY-n.top-l.offsetHeight/2-document.documentElement.scrollTop||document.body.scrollTop)+"px",l.style.left=(r.pageX-n.left-l.offsetWidth/2-document.documentElement.scrollLeft||document.body.scrollLeft)+"px"}return l.style.backgroundColor=i.color,l.className="waves-ripple z-active",!1}},!1)}}),o=function(e){e.directive("waves",i)};window.Vue&&(window.waves=i,Vue.use(o)),i.install=o;t.a=i},jUE0:function(e,t,r){}}]);